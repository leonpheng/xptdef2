

$PROBLEM Example NM-TRAN Control Stream for a 2-cmt Model
$DATA  ../ODON_POPPK_31OCT20.csv IGNORE=#
$INPUT  ID DV LNDV AMT EVID MDV TIME FORM FAST AGE SEX RACE COUNTRY BHT BWT BBSA BBMI BALB ALB BALP ALP 
		BALT ALT BAST AST BBILI BILI BCREAT CREAT BCRCL CRCL BEGFR EGFR TULOC TUTYPE ECOG 
		PPI CYPINH CYPIND BHEPIMP HEPIMP BRIMPC RIMPC BRIMPE RIMPE  
		
$SUBROUTINES ADVAN4 TRANS4
$PK

TVCL = THETA(1)
CL = TVCL * EXP(ETA(1))
TVV = THETA(2)
V2 = TVV * EXP(ETA(2))
TVQ = THETA(3)
Q = TVQ * EXP(ETA(3))
TVV3 = THETA(4)
V3 = TVV3 * EXP(ETA(4))
TVKA = THETA(5)
KA = TVKA


; scale predictions based on dose (mg) and Cp (ng/mL)
S2 = V2/1000


$ERROR

IPRED= F
Y = F + F * EPS(1) + EPS(2) 
 IRES= DV - IPRED

$THETA    (0,10)     ; Clearance (L/h)
          (0,100)    ; V2 (L)
		  (0,20)     ; Q (L/h)
          (0,1000)    ; V3 (L)
          (0,0.01)   ; Absorption Rate (1/h)


$OMEGA    (0.1)    ; IIV on CL 
          (0.1)    ; IIV on V2 
		  (0.1)    ; IIV on Q 
          (0.1)    ; IIV on V3 
$SIGMA    (0.4)    ; EPS1
(0.4)    ; EPS2 

; Use conditional estimation with interaction
$ESTIMATION METHOD=1 INTER MAXEVAL=9999 PRINT=1 NOABORT SIG=6 MSFO=cpt2.msf

$TABLE NOPRINT ONEHEADER NOAPPEND FILE=cpt2.tab
ID TIME EVID AMT MDV DV PRED RES WRES IPRED CWRES IRES
FORM FAST AGE SEX RACE COUNTRY BHT BWT BBSA BBMI BALB ALB BALP ALP 
BALT ALT BAST AST BBILI BILI BCREAT CREAT BCRCL CRCL BEGFR EGFR TULOC TUTYPE ECOG 
PPI CYPINH CYPIND BHEPIMP HEPIMP BRIMPC RIMPC BRIMPE RIMPE
ETAS(1:LAST)