detail$SAS.label<-capitalize(as.character(detail$Enter.label.here))
pkdata <- read.csv(paste(input,inp$input[j],sep="/"),stringsAsFactors = FALSE)
pkdata<-chclass(pkdata,names(pkdata),"char")
names(pkdata)<-toupper(names(pkdata))
pkdata<-chclass(pkdata,names(pkdata),"char")
#keepnum<-intersect(names(pkdata),numkeep)
if(!is.null(checkclass)){
pkdata<-autoclass(pkdata)
}
#else{pkdata<-chclass(pkdata,keepnum,"num")}
for (h in 1:nrow(detail)){
tryCatch(label(pkdata[,paste(detail$Variable[h])])<- paste(detail$SAS.label[h]),error=function(e) NULL )
}
label(pkdata)<-inp$lab[j]
rangepkdat <- vardefine(pkdata,maxlevel=10,labels=T,digits=6,vartype=T,exp.csv=T) # same as previous, to export to csv
detail1<- detail #read.xls(paste(location,"/make defines library.xls",sep=""),sheet=1,method="tab")
detail1<-detail1[!duplicated(detail1$Variable),]
detail1<-detail1[detail1$Variable%in%unique(rangepkdat$Variable),]
rangepkdat<-merge(rangepkdat,detail1[,c("Variable","Unit","Detailed.description")],by=c("Variable","Variable"),all.x=T,sort=F)
#File name should not exceed 8 characters- NOTE that all variable names will be limited to 8 characters
name<-as.character(inp$outp[j])
assign(name,pkdata)
file1<-paste(inp$outp[j],".xpt",sep="")
sav<-paste0("write.xport(",inp$outp[j],",file=file1,autogen.formats=FALSE)")
setwd(outputdir)
eval(parse(text=sav))
require(SASxport)   # to be able to read the xport files
data<-read.xport(paste(outputdir,"/",inp$outp[j],".xpt",sep=""))
definedataset <- data.frame(Variable=colnames(data))
range<-vardefine(data,maxlevel=10,labels=T,digits=6,vartype=T,exp.csv=T)
data1<-data.frame(var=colnames(data))
rangepkdat$Type<-range$Type
rangepkdat$Variable<-range$Variable
rangepkdat$"Code/Range"<-range$"Code/Range"
names(rangepkdat)<-c("SAS Variable","SAS Label","Type","Code/Range","Unit","Detailed.description")
rangepkdat<-rangepkdat[,c("SAS Variable","SAS Label","Type","Code/Range","Unit","Detailed.description")]
rangepkdat$"SAS Variable"<-gsub(rangepkdat$"SAS Variable",pattern="\\_",replacement="XXXX")
detach("package:SASxport", unload = T)
ind<-as.numeric(row.names(rangepkdat[rangepkdat$"Code/Range"=="-",]))
if(length(ind)>0){
rgd<-rangepkdat
for(i in 1:length(ind)){
x<-ifelse(length(unique(data[,ind[i]]))>5,paste(paste(as.character(unique(data[,ind[i]])[1:5]),collapse=", ",sep=""),",..."),paste(as.character(unique(data[,ind[i]])),collapse=", ",sep=""))
rgd[ind[i],"Code/Range"]<-x}}else{rgd<-rangepkdat}
if(!is.null(range.character)){
write.csv(rgd,paste(inp$outp[j],"define.csv",sep=""),row.names=F)}else{
write.csv(rangepkdat,paste(inp$outp[j],"define.csv",sep=""),row.names=F)
}
setwd("../../")
getwd()
}
library(xptdef2)
working.folder= "C:/Users/lpheng/Desktop/test"
step1(working.folder)
define.library="studydefinelist.csv"
step2()
title="test"
step4(title=title)
input<-paste0(pathdir,"/input")# This folder should contain all csv data
progdir <- paste0(pathdir,"/output/programs")# This folder should contain all program and output .txt
outputdir<-paste0(pathdir,"/output/datasets") # This folder for resulted output
#setwd(outputdir)
dir()
#lst<- read.xls(paste(pathwork,"list of files.xlsx",sep="/"), sheet = 1)
lst<- read.csv(paste(pathwork,"list of files.csv",sep="/"))
prog<-unlist(paste0(lst$renam[lst$type=="prog"],".txt"))
progdes<-unlist(paste0(lst$description[lst$type=="prog"]))
origprog<-unlist(paste0(lst$filename [lst$type=="prog"]))
prog
progdes
origprog
location<-paste0("#programs#",prog)
doc<-addTitle(doc, "PROGRAMS TABLE OF CONTENTS",level=1)
dir(progdir)
include<-paste0(lst$rename[lst$progNo!=""],".txt")
IOD<-lst[lst$progNo%in%lst$progNo[lst$progNo!=""]&!is.na(lst$progNo),]
ind<-lst[rownames(lst)%in%rownames(IOD),]
prono<-lst[rownames(lst)%in%rownames(IOD),"progNo"]
include
IOD
ind
prono
nrow(IOD)>0
prog<-unlist(paste0(ind$renam[ind$type=="prog"],".txt"))
progdes<-unlist(paste0(ind$description[ind$type=="prog"]))
origprog<-unlist(paste0(ind$filename[ind$type=="prog"]))
tab3data<-data.frame(Program="",
Description=IOD$description,
Input_Output_Dependency="")
tab = FlexTable(data = tab3data, header.columns=T)
tab
length(origprog)
i=1
op<-paste0("./programs/",prog[i])
op
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
tab
io1<-lst[grep(prono[i],lst$proNo.input)&!is.na(lst$proNo.input),]
io2<-lst[grep(prono[i],lst$proNo.output)&!is.na(lst$proNo.output),]
io3<-lst[grep(prono[i],lst$progNo.dependent)&!is.na(lst$progNo.dependent),]
nrow(io1)==0
nrow(io1)
io1
prono
prono[i]
lst$proNo.input
!is.na(lst$proNo.input)
!is.na(lst$proNo.output)
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io1
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io2
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
nrow(io1)==0
if(nrow(io1)==0){
tt =  pot("",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("Input",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("Input",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("Input",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
tt
if(nrow(io1)==0){
tt =  pot("",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("Input",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}}
tab
tab = FlexTable(data = tab3data, header.columns=T)
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("Input",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}}
tt
tt1
nrow(io3)==0
nrow(io2)==0
io2
io1
io2
io3
nrow(io1)==0
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] ="Input\n  "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
tab
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("Input",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =pot("Input",textBold())+"\n  "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}}
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("Input",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =pot("Input",textBold())+"\n  "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}
tab
tab = FlexTable(data = tab3data, header.columns=T)
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("Input",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot("",textBold())+"\n "+ pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =pot("Input",textBold())+"\n  "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}
tab
tab = FlexTable(data = tab3data, header.columns=T)
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("Input",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =pot("Input",textBold())+"\n"+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}
tab
pot("Input",textBold())+"\n "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
tab = FlexTable(data = tab3data, header.columns=T)
for(i in 1:length(origprog)){
op<-paste0("./programs/",prog[i])
tab[i,1] = pot(prog[i],hyperlink =op,
textBold( color = '#0000EE', underline = F ) )+ " \n(original:" +pot(origprog[i])+")"
io1<-lst[grep(prono[i],lst$proNo.input)&lst$proNo.input!="",]
io2<-lst[grep(prono[i],lst$proNo.output)&lst$proNo.output!="",]
io3<-lst[grep(prono[i],lst$progNo.dependent)&lst$progNo.dependent!="",]
if(nrow(io1)==0){
tt =  pot("Input",textBold())
}else{
for(io in 1:nrow(io1)){
txtins<-paste0(io1$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io1$filename[io],")")
if(io==1){
tt=pot(txtins,hyperlink= insert,
textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt =pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ))+"\n  "+pot(orf,textNormal())
}}
if(nrow(io2)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io2)){
txtins<-paste0(io2$rename[io],".xpt")
insert<-paste0("./datasets/",txtins)
orf<-paste0("(original:",io2$filename[io],")")
if(io==1){
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt1=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
if(nrow(io3)==0){
tt1 =  pot("",textBold())
}else{
for(io in 1:nrow(io3)){
txtins<-paste0(io3$rename[io],".txt")
insert<-paste0("./programs/",txtins)
orf<-paste0("(original:",io3$filename[io],")")
if(io==1){
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())+"\n"
}else{
tt2=pot(txtins,hyperlink= insert,textBold( color = '#0000EE', underline = F ) )+"\n  "+pot(orf,textNormal())}}}
tab[i,3] =pot("Input",textBold())+"\n "+tt+"\n  "+pot("Output",textBold())+"\n  "+tt1+"\n  "+pot("Dependent",textBold())+"\n  "+tt2
}}
tab
setwd("C:/Users/lpheng/Desktop/packdev/xptdef2")
devtools::document()
devtools::install_github("leonpheng/xptdef2")
library(xptdef2)
working.folder= "C:/Users/lpheng/Desktop/test"
step1(working.folder)
setwd("C:/Users/lpheng/Desktop/packdev/xptdef2")
devtools::document()
devtools::install_github("leonpheng/xptdef2")
